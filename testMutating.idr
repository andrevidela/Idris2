module Main

import Data.Nat

data Test : Type where
  Simple : Nat -> Test
  Doubling : Nat -> Nat -> Test

%mutating
update : (1 _ : Test) -> Test
update (Simple n) = Simple (S n)
update (Doubling a b) = Doubling (S a) (S (S b))

repeat : Nat -> ((1 _ : a) -> a) -> (1 _ : a) -> a
repeat Z f a = f a
repeat (S n) f a = f (repeat n f a)

isEven : (1 _ : Nat) -> Bool
isEven Z = True
isEven (S n) = not (isEven n)

toNat : (1 _ : Test) -> Nat
toNat (Simple n) = n
toNat (Doubling n n') = n

main : IO ()
main = let 1 val = Simple 3
           1 updated = update val 
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
           1 updated = update updated
        in if isEven (toNat updated) then putStrLn "even" else putStrLn "odd"
